<h1>Listing events</h1>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Total balance</th>
      <th>What is owed
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @events.each do |event| %>
      <tr>
        <td><%= event.name %></td>
        <td><%= event.description %></td>
        <td><%= event.total_balance %></td>
        <td>
          <%= button_to('Show', event, :class => 'btn btn-med btn-primary', :method => :get) %>
        </td>

        <td>
          <%= button_to new_purchase_url, :method => :get, :class => 'btn btn-med btn-primary' do %>
          Add Purchase
          <%= hidden_field_tag :event_id, event.id %>
          <% end %>
        </td>

        <td>
          <%= button_to new_payment_url, :method => :get, :class => 'btn btn-med btn-primary' do %>
          Add Payment
          <%= hidden_field_tag :event_id, event.id %>
          <% end %>
        </td>




        <% if event.organizer == current_user.id %>
          <td>
            <%= button_to('Edit', edit_event_path(event), :class => 'btn btn-med btn-primary', :method => :get) %>
          </td>
        <% end %>

        <% if event.organizer == current_user.id %>
          <td>
            <%= button_to('Destroy', event, :class => 'btn btn-med btn-primary', :method => :delete, data: {confirm: 'Are you sure?'} ) %>
          </td>
        <% end %>

        <!-- For debugging -->
        <% event.user_event_balances.each do |ueb| %>
          <td><%= ueb.user.email %></td>          
          <td><%= ueb.amount %></td>
          <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<div>
<%= button_to('New Event', new_event_path, :class => 'btn btn-med btn-primary', :method => :get) %>
</div>
